/*! lost.js 0.0.1
 Author: Nelson Darkwah Oppong
 License: MIT  */
var indexOf;indexOf=Array.prototype.indexOf?function(a,b){return a.indexOf(b)}:function(a,b){for(var c=0,d=a.length;c<d;c++)if(a[c]===b)return c;return-1};var verifyArgumentsLength=function(a,b,c){if(a.length!=b)throw new Error("Lost."+c+" needs "+b+" argument"+a.length!=1?"s":" ("+a.length+" were given)")},Lost=function(a,b){if(this.namespace=a,null!==typeof b&&"object"==typeof b&&void 0!==typeof b.encode&&void 0!==typeof b.decode){if("function"!=typeof b.encode||"function"!=typeof b.decode)throw new Error("Lost.create needs encode and decode functions");var c=JSON.stringify({i:0}),d=b.encode,e=b.decode;if(e(d(c))!==c)throw new Error("Lost.create needs decode(encode(value)) to be the identity map");this._encode=b.encode,this._decode=b.decode}};Lost.create=function(a,b){var c=new Lost(a,b);return c._initialize(),c},Lost.prototype={_initialize:function(){var a=this._namespaced("keys","-");null!==this.keys()&&void 0!==this.keys()||this._set(a,[])},_encode:function(a){return a},_decode:function(a){return a},_exec:function(a,b,c){var d=window.localStorage;switch(a){case"set":c=this._encode(JSON.stringify(c)),d.setItem(b,c);break;case"get":if(c=d.getItem(b),void 0===c||null===c)return;return JSON.parse(this._decode(c));case"del":d.removeItem(b)}},_set:function(a,b){this._exec("set",a,b)},_get:function(a){return this._exec("get",a)},_namespaced:function(a,b){return this.globalNamespace+":"+this.namespace+(b||":")+a},globalNamespace:"Lost",set:function(a,b){verifyArgumentsLength(arguments,2,"set");var c=this.keys();indexOf(c,a)<0&&c.push(a),this._set(this._namespaced("keys","-"),c),this._set(this._namespaced(a),b)},get:function(a){if(verifyArgumentsLength(arguments,1,"get"),this.exists(a))return this._get(this._namespaced(a))},del:function(a){if(verifyArgumentsLength(arguments,1,"del"),!this.exists(a))return!1;var b=this.keys();return b.splice(indexOf(b,a),1),this._set(this._namespaced("keys","-"),b),this._exec("del",this._namespaced(a)),!0},keys:function(){return this._get(this._namespaced("keys","-"))},exists:function(a){return verifyArgumentsLength(arguments,1,"exists"),indexOf(this.keys(),a)>-1},size:function(){for(var a=this.keys(),b=this._namespaced("").length,c=0,d=0,e=a.length;d<e;d++){var f=a[d];c+=b+f.length,c+=(window.localStorage.getItem(f)||"").length}return c+=b+JSON.stringify(a).length,2*c},flush:function(){for(var a=this.keys(),b=this,c=0,d=a.length;c<d;c++)b.del(a[c])},toString:function(){return"<Lost:"+this.namespace+" ~"+this.size()+" bytes, "+this.keys().length+" keys: "+this.keys().join(", ")+">"}},void 0===window.Lost&&(window.Lost=Lost);
